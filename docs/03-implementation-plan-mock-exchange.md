# 구현 계획 (Mock Exchange 1차)

## 1. 요구사항 고정
- 100% 현금주문
- 일반주문(매수/매도 + 시장가/지정가)
- 내부 Mock Exchange 기반 체결
- 부분체결 지원

## 2. 도메인 모델링
- 주문(`Order`) 엔티티 및 상태 머신
- 선점(`OrderHold`) 엔티티
- 체결(`Fill`) 엔티티
- 고정 시세(`MockQuote`) 엔티티

## 3. Broker Core 구현
- 주문 생성 API
- 주문 취소 API
- 주문 단건 조회 API
- 사전체크(주문가능금액/주문가능수량)
- 선점/해제 로직

## 4. Mock Exchange 구현
- `OrderExecutionGateway` 인터페이스
- `MockExchangeEngine` 구현체
- 시세 기반 체결 판단
- 부분체결 및 상태 전이
- 시세 갱신 시 재매칭

## 5. 후처리 구현
- 체결 이벤트 반영
- 잔고/평단/손익 반영(1차 단순화)
- 수수료/세금 계산 훅 추가(초기엔 단순 규칙)

## 6. 테스트
- 주문 생성 성공/실패
- 시장가 즉시 체결
- 지정가 미체결 후 시세갱신 체결
- 부분체결 -> 완전체결
- 부분체결 후 취소(잔량 해제)
- 멱등성(중복 요청/중복 이벤트)

## 7. 리뷰 기준
- ResponseEntity 미사용 여부
- 에러코드/상태코드 정책 준수
- 도메인 정합성(선점/체결/해제)
- 테스트 커버 여부
